
{
  "name": "Essbase Calc Script",
  "scopeName": "source.essbase",
  "patterns": [
    { "include": "#comments" },
    { "include": "#constants" },
    { "include": "#keywords" },
    { "include": "#strings" },
    { "include": "#variables" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.essbase",
          "begin": "\/[*]",
          "end": "[*](\/)"
        },
        {
          "name": "comment.block.essbase",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.character",
          "match": "(<|>|=|!|\\+|-|\\*|%|/)"
        },
        {
          "name": "constant.language",
          "match": "(?i)\\b(AGG|CALC|SET|CCONV|CLEARBLOCK|CLEARCCTRACK|CLEARDATA|DATACOPY|LOOP|ENDLOOP|EXCLUDE|ENDEXCLUDE|AND|OR|NOT)\\b"
        },
        {
          "name": "constant.missing",
          "match": "(?i)#+\\b(MISSING)\\b"
        },
        {
          "name": "constant.numeric",
          "match": "[0-9]"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.essbase",
          "match": "(?i)@+\\b(ABS|ACCUM|ALIAS|ALLANCESTORS|ALLOCATE|ANCEST|ANCESTORS|ANCESTVAL|ATTRIBUTE|ATTRIBUTEBVAL|ATTRIBUTESVAL|ATTRIBUTEVAL|AVG|AVGRANGE|BETWEEN|CALCMODE|CHILDREN|COMPOUND|COMPOUNDGROWTH|CONCATENATE|CORRELATION|COUNT|CURGEN|CURLEV|CURRMBR|CURRMBRRANGE|DATEDIFF|DATEPART|DATEROLL|DECLINE|DESCENDANTS|DISCOUNT|ENUMVALUE|EQUAL|EXP|EXPAND|FACTORIAL|FORMATDATE|GEN|GENMBRS|GROWTH|IALLANCESTORS|IANCESTORS|ICHILDREN|IDESC|IDESCENDANTS|ILANCESTORS|ILDESCENDANTS|ILSIBLINGS|INT|INTEREST|IRDESCENDANTS|IRR|IRSIBLINGS|ISACCTYPE|ISANCEST|ISCHILD|ISDESC|ISGEN|ISIANCEST|ISIBLINGS|ISICHILD|ISIDESC|ISIPARENT|ISISIBLING|ISLEV|ISMBR|ISPARENT|ISSAMEGEN|ISSAMELEV|ISSIBLING|ISUDA|LANCESTORS|LDESCENDANTS|LEV|LEVMBRS|LIKE|LIST|LN|LOG|LOG10|LSIBLINGS|MATCH|MAX|MAXRANGE|MAXS|MAXSRANGE|MBRCOMPARE|MBRPARENT|MDALLOCATE|MDANCESTVAL|MDPARENTVAL|MDSHIFT|MEDIAN|MEMBER|MERGE|MIN|MINRANGE|MINS|MINSRANGE|MOD|MODE|MOVAVG|MOVMAX|MOVMED|MOVMIN|MOVSUM|MOVSUMX|NAME|NEXT|NEXTS|NEXTSIBLING|NOTEQUAL|NPV|PARENT|PARENTVAL|POWER|PREVSIBLING|PRIOR|PRIORS|PTD|RANGE|RANK|RDESCENDANTS|RELATIVE|REMAINDER|REMOVE|RETURN|ROUND|RSIBLINGS|SANCESTVAL|SHARE|SHIFT|SHIFTMINUS|SHIFTPLUS|SHIFTSIBLING|SIBLINGS|SKIPMISSING|SLN|SPARENTVAL|SPLINE|STDEV|STDEVP|STDEVRANGE|SUBSTRING|SUM|SUMRANGE|SYD|TODATE|TODATEEX|TODAY|TREND|TRUNCATE|UDA|VAR|VARIANCE|VARIANCEP|VARPER|WITHATTR|XRANGE|XREF|XWRITE)\\b"
        },
        { 
          "name": "keyword.other.essbase",
          "match": "(?i)\\b(IF|ELSE|ELSEIF|ENDIF|FIX|ENDFIX)\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.single.essbase",
          "begin": "'",
          "end": "'"
        },
        {
          "name": "string.quoted.double.essbase",
          "begin": "\"",
          "end": "\""
        }
      ]
    },
    "variables": {
      "patterns": [
        { 
          "name": "variable.language.essbase",
          "match": "(?i)\\b(AGGMISSG|ALL|ARRAY|AVERAGE|CACHE|CALCPARALLEL|CALCTASKDIMS|CCTRACKCALC|CLEARUPDATESTATUS|COPYMISSINGBLOCK|CREATEBLOCKONEQ|CREATENONMISSINGBLK|DATAEXPORT|DATAEXPORTCOLFORMAT|DATAEXPORTDRYRUN|DATAEXPORTDYNAMICCALC|DATAEXPORTLEVEL|DATAEXPORTNONEXISTINGBLOCKS|DATAEXPORTOPTIONS|DATAEXPORTOVERWRITEFILE|DATAEXPORTRELATIONALFILE|DEFAULT|DIM|EMPTYMEMBERSETS|ERROR|FIRST|FRMLBOTTOMUP|HIGH|LAST|LOCKBLOCK|LOW|MSG|NOTICE|OFF|ON|TO|TWOPASS|UPDATECALC|UPTOLOCAL|VAR)\\b" 
        },
        {
          "name": "variable.substitution.essbase",
          "match": "(?i)&+\\b(\\w+)\\b"
        }
      ]
    }    
  }
}
