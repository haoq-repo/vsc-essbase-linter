
{
  "name": "Essbase Calc Script",
  "scopeName": "source.essbase",
  "patterns": [
    { "include": "#comments" },
    { "include": "#constants" },
    { "include": "#keywords" },
    { "include": "#strings" },
    { "include": "#variables" }
  ],
  "repository": {
    "comments": {
      "patterns": [
        {
          "name": "comment.line.double-slash.essbase",
          "begin": "\/[*]",
          "end": "[*](\/)"
        },
        {
          "name": "comment.block.essbase",
          "begin": "/\\*",
          "end": "\\*/"
        }
      ]
    },
    "constants": {
      "patterns": [
        {
          "name": "constant.character",
          "match": "(<|>|=|!|\\+|-|\\*|%|/)"
        },
        {
          "name": "constant.language",
          "match": "(?i)\\b(AGG|ARRAY|CALC|CCONV|CLEARBLOCK|CLEARCCTRACK|CLEARDATA|DATACOPY|DATAEXPORT|DATAEXPORTCOND|DATAIMPORTBIN|DATAMERGE|POSTFIXPARALLEL|AND|OR|NOT|SET)\\b"
        },
        {
          "name": "constant.missing",
          "match": "(?i)#+\\b(MISSING)\\b"
        },
        {
          "name": "constant.numeric",
          "match": "[0-9]"
        }
      ]
    },
    "keywords": {
      "patterns": [
        {
          "name": "keyword.control.essbase",
          "match": "(?i)@+\\b(ABS|ACCUM|ALIAS|ALLANCESTORS|ALLOCATE|ANCEST|ANCESTORS|ANCESTVAL|ATTRIBUTE|ATTRIBUTEBVAL|ATTRIBUTESVAL|ATTRIBUTEVAL|AVG|AVGRANGE|BETWEEN|CALCMODE|CHILDREN|COMPOUND|COMPOUNDGROWTH|CONCATENATE|CORRELATION|COUNT|CREATEBLOCK|CURGEN|CURLEV|CURRMBR|CURRMBRRANGE|DATEDIFF|DATEPART|DATEROLL|DECLINE|DESCENDANTS|DISCOUNT|ENUMVALUE|EQUAL|EXP|EXPAND|FACTORIAL|FORMATDATE|GEN|GENMBRS|GRIDTUPLES|GROWTH|IALLANCESTORS|IANCESTORS|ICHILDREN|IDESC|IDESCENDANTS|ILANCESTORS|ILDESCENDANTS|ILSIBLINGS|INT|INTEREST|INTERSECT|IRDESCENDANTS|IRR|IRREX|IRSIBLINGS|ISACCTYPE|ISATTRIBUTE|ISANCEST|ISCHILD|ISDESC|ISGEN|ISIANCEST|ISIBLINGS|ISICHILD|ISIDESC|ISIPARENT|ISISIBLING|ISLEV|ISMBR|ISMBRUDA|ISMBRWITHATTR|ISPARENT|ISRANGENONEMPTY|ISSAMEGEN|ISSAMELEV|ISSIBLING|ISUDA|LANCESTORS|LDESCENDANTS|LEV|LEVMBRS|LIKE|LIST|LN|LOG|LOG10|LSIBLINGS|MATCH|MAX|MAXRANGE|MAXS|MAXSRANGE|MBRCOMPARE|MBRPARENT|MDALLOCATE|MDANCESTVAL|MDPARENTVAL|MDSHIFT|MEDIAN|MEMBER|MEMBERAT|MERGE|MIN|MINRANGE|MINS|MINSRANGE|MOD|MODE|MOVAVG|MOVMAX|MOVMED|MOVMIN|MOVSUM|MOVSUMX|NAME|NEXT|NEXTS|NEXTSIBLING|NONEMPTYTUPLE|NOTEQUAL|NPV|PARENT|PARENTVAL|POWER|PREVSIBLING|PRIOR|PRIORS|PTD|QUERYBOTTOMUP|RANGE|RANGEFIRSTVAL|RANGELASTVAL|RANK|RDESCENDANTS|RELATIVE|REMAINDER|REMOVE|RETURN|ROUND|RSIBLINGS|SANCESTVAL|SHARE|SHIFT|SHIFTMINUS|SHIFTPLUS|SHIFTSIBLING|SIBLINGS|SKIPMISSING|SLN|SPARENTVAL|SPLINE|STDEV|STDEVP|STDEVRANGE|SUBSTRING|SUM|SUMRANGE|SYD|TODATE|TODATEEX|TODAY|TREND|TRUNCATE|UDA|VAR|VARPER|VARIANCE|VARIANCEP|WEIGHTEDSUMX|WITHATTR|XRANGE|XREF|XWRITE)\\b"
        },
        { 
          "name": "keyword.other.essbase",
          "match": "(?i)\\b(IF|ELSE|ELSEIF|ENDIF|EXCLUDE|ENDEXCLUDE|FIX|ENDFIX|LOOP|ENDLOOP)\\b"
        }
      ]
    },
    "strings": {
      "patterns": [
        {
          "name": "string.quoted.single.essbase",
          "begin": "'",
          "end": "'"
        },
        {
          "name": "string.quoted.double.essbase",
          "begin": "\"",
          "end": "\""
        }
      ]
    },
    "variables": {
      "patterns": [
        { 
          "name": "variable.language.essbase",
          "match": "(?i)\\b(AGGMISSG|ALL|ARRAY|AVERAGE|CACHE|CALCDIAGNOSTICS|CALCPARALLEL|CALCTASKDIMS|CCTRACKCALC|CLEARUPDATESTATUS|COPYMISSINGBLOCK|CREATENONMISSINGBLK|CREATEBLOCKONEQ|DATAEXPORTCOLFORMAT|DATAEXPORTDRYRUN|DATAEXPORTDYNAMICCALC|DATAEXPORTLEVEL|DATAEXPORTNONEXISTINGBLOCKS|DATAEXPORTOPTIONS|DATAEXPORTOVERWRITEFILE|DATAEXPORTRELATIONALFILE|DATAIMPORTIGNORETIMESTAMP|DEFAULT|DIM|EMPTYMEMBERSETS|ERROR|FIRST|FRMLBOTTOMUP|FRMLRTDYNAMIC|HIGH|HYBRIDBSOINCALCSCRIPT|LAST|LOCKBLOCK|LOW|MSG|NOTICE|OFF|ON|REMOTECALC|RUNTIMESUBVARS|SCAPERSPECTIVE|TO|THREADVAR|TRACE|TRACEID|TWOPASS|UPDATECALC|UPTOLOCAL|USE_MDX_INSERT|VAR)\\b" 
        },
        {
          "name": "variable.substitution.essbase",
          "match": "(?i)&+\\b(\\w+)\\b"
        }
      ]
    }    
  }
}
